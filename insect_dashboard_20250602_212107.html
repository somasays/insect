
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSECT Security Dashboard</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --primary-dark: #1d4ed8;
            --critical-color: #ef4444;
            --high-color: #f97316;
            --medium-color: #eab308;
            --low-color: #22c55e;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --background: #0f172a;
            --card-bg: #1e293b;
            --border-color: #334155;
            --text-color: #f8fafc;
            --text-muted: #94a3b8;
        }

        body {
            font-family: 'SF Mono', 'Monaco', 'Cascadia Code', 'Roboto Mono', monospace;
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--background);
            margin: 0;
            padding: 1rem;
        }

        .dashboard {
            display: grid;
            grid-template-rows: auto auto 1fr;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            height: 100vh;
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            grid-column: 1 / -1;
            background-color: var(--card-bg);
            border: 2px solid var(--primary-color);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .scan-info {
            font-size: 1rem;
            font-weight: bold;
        }

        .insights {
            grid-column: 1 / -1;
            background-color: var(--card-bg);
            border: 2px solid var(--warning-color);
            border-radius: 0.5rem;
            padding: 1rem;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-explorer {
            background-color: var(--card-bg);
            border: 2px solid var(--success-color);
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-y: auto;
        }

        .issue-detail {
            background-color: var(--card-bg);
            border: 2px solid var(--error-color);
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-y: auto;
        }

        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }

        .tree-item {
            padding: 0.25rem 0;
            cursor: pointer;
            border-radius: 0.25rem;
            user-select: none;
        }

        .tree-item:hover {
            background-color: rgba(59, 130, 246, 0.1);
        }

        .tree-item.selected {
            background-color: rgba(59, 130, 246, 0.2);
        }

        .tree-item.directory {
            font-weight: 500;
        }

        .tree-item.file {
            margin-left: 1rem;
        }

        .tree-children {
            margin-left: 1rem;
            display: none;
        }

        .tree-children.expanded {
            display: block;
        }

        .severity-critical { color: var(--critical-color); }
        .severity-high { color: var(--high-color); }
        .severity-medium { color: var(--medium-color); }
        .severity-low { color: var(--low-color); }

        .issue-header {
            background-color: rgba(59, 130, 246, 0.1);
            padding: 0.75rem;
            border-radius: 0.25rem;
            margin-bottom: 0.5rem;
            border-left: 4px solid var(--primary-color);
        }

        .issue-content {
            padding: 0.5rem;
        }

        .issue-navigation {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .nav-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
            font-family: inherit;
        }

        .nav-button:hover {
            background-color: var(--primary-dark);
        }

        .nav-button:disabled {
            background-color: var(--border-color);
            cursor: not-allowed;
        }

        .help-text {
            text-align: center;
            color: var(--text-muted);
            font-style: italic;
            margin: 2rem 0;
        }

        .expand-icon {
            display: inline-block;
            width: 1rem;
            margin-right: 0.25rem;
            transition: transform 0.2s;
        }

        .expand-icon.expanded {
            transform: rotate(90deg);
        }

        .keyboard-hint {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 0.75rem;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .export-button {
            position: fixed;
            top: 1rem;
            right: 1rem;
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
        }

        .export-button:hover {
            background-color: #059669;
        }

        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto auto;
            }
            
            .header, .insights {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>
    <button class="export-button" onclick="exportReport()">üìÑ Export Report</button>
    
    <div class="dashboard">
        <div class="header">
            <div class="scan-info">
                üîç <strong>/Users/soma/ssa/code/personal/insect</strong> | üìÅ 246 files | ‚è±Ô∏è 1.3s | üêõ <strong>35 issues</strong>
            </div>
            <div style="margin-top: 0.5rem;">
                <strong>Risk:</strong> <span class="severity-critical">CRITICAL</span>
            </div>
        </div>

        <div class="insights">
            <div class="section-title">üìã Key Insights</div>
            <div id="insights-content">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <div class="file-explorer">
            <div class="section-title">üìÅ File Explorer</div>
            <div id="file-tree">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <div class="issue-detail">
            <div class="section-title">üêõ Issue Details</div>
            <div id="issue-content">
                <div class="help-text">Select a file to view issues</div>
            </div>
        </div>
    </div>

    <div class="keyboard-hint">
        <div><strong>Navigation:</strong></div>
        <div>Click files to view issues</div>
        <div>Use Next/Previous buttons to navigate issues</div>
        <div>E - Export detailed report</div>
    </div>

    <script>
        // Data from the backend
        const findings = [{"id": "DEPENDENCIES-MISSING-356c31fd", "title": "External dependencies missing", "description": "Some external dependencies are not installed or not in PATH: bandit, semgrep, shellcheck, trivy, grype, safety. This limits the thoroughness of the scan.", "severity": "low", "severity_label": "LOW", "type": "other", "type_label": "Other", "location": ".", "location_file": ".", "location_line": null, "remediation": "Run 'insect deps --install-deps' to automatically install missing dependencies.", "references": [], "confidence": "100%", "analyzer": "dependency_check", "created_at": "2025-06-02 20:23:50", "cwe_id": "", "cvss_score": 0.0}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "RELEASE_NOTES_v0.1.4.md:77", "location_file": "RELEASE_NOTES_v0.1.4.md", "location_line": 77, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/test_utils.py:171", "location_file": "tests/unit/test_utils.py", "location_line": 171, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/test_utils.py:172", "location_file": "tests/unit/test_utils.py", "location_line": 172, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:129", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 129, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x1234567890abcdef12...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:125", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 125, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.79\nDetected value: 1BvBMSEYstWetqTFn5Au...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:360", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 360, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.59\nDetected value: 1F1tAaz5x1HUXrCNLbtM...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:527", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 527, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.55\nDetected value: bc1qw508d6qejxtdg4y5...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:646", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 646, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.54\nDetected value: bip32utils.BIP32Key....", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_crypto_wallet_analyzer.py:190", "location_file": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "location_line": 190, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.51\nDetected value: DependencyStatus.VER...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_dependency_manager.py:159", "location_file": "tests/unit/analysis/test_dependency_manager.py", "location_line": 159, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:101", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 101, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:102", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 102, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-GITHUB_TOKEN", "title": "Secret detected: GitHub Token", "description": "GitHub Personal Access Token detected\n\nDetected value: ghp_1234567890abcdef...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:122", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 122, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: postgresql://user:su...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:138", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 138, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: mongodb://admin:pass...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:139", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 139, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-JWT_TOKEN", "title": "Secret detected: JWT Token", "description": "JSON Web Token (JWT) detected\n\nDetected value: eyJhbGciOiJIUzI1NiIs...", "severity": "medium", "severity_label": "MEDIUM", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:155", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 155, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:333", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 333, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x4c0883a69102937d62...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:350", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 350, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-SSH_PRIVATE_KEY", "title": "Secret detected: SSH Private Key", "description": "SSH private key detected\n\nDetected value: -----BEGIN RSA PRIVA...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:171", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 171, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.64\nDetected value: R$p9#mK@L2qX7vN!eA1f...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/test_secret_analyzer.py:48", "location_file": "tests/unit/analysis/test_secret_analyzer.py", "location_line": 48, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY_STRING", "title": "Secret detected: High Entropy String", "description": "High-entropy string that may be a secret\n\nDetected value: Y3VybCAtcyBodHRwOi8v...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "tests/unit/analysis/shell/test_analyzer.py:122", "location_file": "tests/unit/analysis/shell/test_analyzer.py", "location_line": 122, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.55\nDetected value: $REPORT_DIR/extensio...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "docs/advanced_usage.md:258", "location_file": "docs/advanced_usage.md", "location_line": 258, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:409", "location_file": "docs/security_examples.md", "location_line": 409, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:410", "location_file": "docs/security_examples.md", "location_line": 410, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-GITHUB_TOKEN", "title": "Secret detected: GitHub Token", "description": "GitHub Personal Access Token detected\n\nDetected value: ghp_1234567890abcdef...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:408", "location_file": "docs/security_examples.md", "location_line": 408, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: postgresql://admin:p...", "severity": "high", "severity_label": "HIGH", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:351", "location_file": "docs/security_examples.md", "location_line": 351, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:713", "location_file": "docs/security_examples.md", "location_line": 713, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x1234567890abcdef12...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:710", "location_file": "docs/security_examples.md", "location_line": 710, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-SSH_PRIVATE_KEY", "title": "Secret detected: SSH Private Key", "description": "SSH private key detected\n\nDetected value: -----BEGIN RSA PRIVA...", "severity": "critical", "severity_label": "CRITICAL", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:431", "location_file": "docs/security_examples.md", "location_line": 431, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.57\nDetected value: sk_live_12345abcdef6...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:352", "location_file": "docs/security_examples.md", "location_line": 352, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.79\nDetected value: 1BvBMSEYstWetqTFn5Au...", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "docs/security_examples.md:800", "location_file": "docs/security_examples.md", "location_line": 800, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.61\nDetected value: DOCKERFILE_TEMPLATE....", "severity": "low", "severity_label": "LOW", "type": "secret", "type_label": "Secret", "location": "src/insect/utils/docker_utils.py:76", "location_file": "src/insect/utils/docker_utils.py", "location_line": 76, "remediation": "", "references": [], "confidence": "100%", "analyzer": "secrets", "created_at": "2025-06-01 08:21:50", "cwe_id": "", "cvss_score": null}, {"id": "DOCKER003-65ffd010", "title": "No USER instruction (running as root)", "description": "No USER instruction found, container will run as root by default.", "severity": "medium", "severity_label": "MEDIUM", "type": "misconfig", "type_label": "Misconfig", "location": "Dockerfile:1", "location_file": "Dockerfile", "location_line": 1, "remediation": "Add a USER instruction to run as a non-privileged user.", "references": ["https://docs.docker.com/develop/develop-images/dockerfile_best-practices/#user"], "confidence": "90%", "analyzer": "config", "created_at": "2025-05-30 13:27:03", "cwe_id": "CWE-250", "cvss_score": 6.0}, {"id": "TOML001-b7c90919", "title": "Insecure dependency version constraints", "description": "Using '*', '>=', or '^' can lead to automatic updates to vulnerable versions.", "severity": "medium", "severity_label": "MEDIUM", "type": "misconfig", "type_label": "Misconfig", "location": "pyproject.toml:22", "location_file": "pyproject.toml", "location_line": 22, "remediation": "Pin dependencies to specific versions.", "references": ["https://python-poetry.org/docs/dependency-specification/"], "confidence": "80%", "analyzer": "config", "created_at": "2025-05-30 13:27:03", "cwe_id": "CWE-1104", "cvss_score": 5.0}];
        const metadata = {"scan_id": "cf21eee8-6f80-4987-9659-644c5dd1cab6", "repository": ".", "timestamp": "2025-06-02T20:23:50.404758", "duration_seconds": 1.2587578296661377, "file_count": 124, "total_files_processed": 246, "finding_count": 35, "enabled_analyzers": ["config", "metadata", "secrets"], "extension_stats": {".md": 25, "": 6, ".py": 76, ".toml": 2, ".html": 1, ".json": 1, ".ini": 1, ".xml": 1, ".lock": 1, ".whl": 1, ".gz": 1, ".yml": 1, ".png": 2, ".txt": 5}, "severity_counts": {"LOW": 12, "MEDIUM": 3, "HIGH": 11, "CRITICAL": 9}, "type_counts": {"OTHER": 1, "SECRET": 32, "MISCONFIG": 2}, "analyzer_counts": {"dependency_check": 1, "secrets": 32, "config": 2}, "is_git_repository": true, "tags": ["DOCKER003", "TOML001", "config", "container", "dependency", "docker", "missing-tool", "security", "toml"], "top_extensions_by_findings": {".py": 21, ".md": 11, "": 2, ".toml": 1}, "configuration": {"min_severity": "low", "include_patterns": ["*"], "exclude_patterns": ["*.git/*", "node_modules/*", "venv/*", ".venv/*", "*.pyc", "__pycache__/*", "*.min.js", "*.min.css"]}, "cache_stats": {"hits": 244, "misses": 0, "files_scanned": 0, "files_skipped": 0}};
        const fileTree = {"name": "insect", "type": "directory", "children": [{"name": "RELEASE_NOTES_v0.1.4.md", "type": "file", "path": "RELEASE_NOTES_v0.1.4.md", "issues": 1, "worst_severity": "critical", "findings": [{"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "line": 77, "remediation": ""}]}, {"name": "tests", "type": "directory", "path": "tests", "children": [{"name": "unit", "type": "directory", "path": "tests/unit", "children": [{"name": "test_utils.py", "type": "file", "path": "tests/unit/test_utils.py", "issues": 2, "worst_severity": "high", "findings": [{"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "line": 171, "remediation": ""}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "line": 172, "remediation": ""}]}, {"name": "analysis", "type": "directory", "path": "tests/unit/analysis", "children": [{"name": "test_crypto_wallet_analyzer.py", "type": "file", "path": "tests/unit/analysis/test_crypto_wallet_analyzer.py", "issues": 6, "worst_severity": "critical", "findings": [{"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "line": 129, "remediation": ""}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x1234567890abcdef12...", "severity": "critical", "line": 125, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.79\nDetected value: 1BvBMSEYstWetqTFn5Au...", "severity": "low", "line": 360, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.59\nDetected value: 1F1tAaz5x1HUXrCNLbtM...", "severity": "low", "line": 527, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.55\nDetected value: bc1qw508d6qejxtdg4y5...", "severity": "low", "line": 646, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.54\nDetected value: bip32utils.BIP32Key....", "severity": "low", "line": 190, "remediation": ""}]}, {"name": "test_dependency_manager.py", "type": "file", "path": "tests/unit/analysis/test_dependency_manager.py", "issues": 1, "worst_severity": "low", "findings": [{"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.51\nDetected value: DependencyStatus.VER...", "severity": "low", "line": 159, "remediation": ""}]}, {"name": "test_secret_analyzer.py", "type": "file", "path": "tests/unit/analysis/test_secret_analyzer.py", "issues": 10, "worst_severity": "critical", "findings": [{"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "line": 101, "remediation": ""}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "line": 102, "remediation": ""}, {"id": "SECRET-GITHUB_TOKEN", "title": "Secret detected: GitHub Token", "description": "GitHub Personal Access Token detected\n\nDetected value: ghp_1234567890abcdef...", "severity": "high", "line": 122, "remediation": ""}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: postgresql://user:su...", "severity": "high", "line": 138, "remediation": ""}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: mongodb://admin:pass...", "severity": "high", "line": 139, "remediation": ""}, {"id": "SECRET-JWT_TOKEN", "title": "Secret detected: JWT Token", "description": "JSON Web Token (JWT) detected\n\nDetected value: eyJhbGciOiJIUzI1NiIs...", "severity": "medium", "line": 155, "remediation": ""}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "line": 333, "remediation": ""}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x4c0883a69102937d62...", "severity": "critical", "line": 350, "remediation": ""}, {"id": "SECRET-SSH_PRIVATE_KEY", "title": "Secret detected: SSH Private Key", "description": "SSH private key detected\n\nDetected value: -----BEGIN RSA PRIVA...", "severity": "critical", "line": 171, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.64\nDetected value: R$p9#mK@L2qX7vN!eA1f...", "severity": "low", "line": 48, "remediation": ""}]}, {"name": "shell", "type": "directory", "path": "tests/unit/analysis/shell", "children": [{"name": "test_analyzer.py", "type": "file", "path": "tests/unit/analysis/shell/test_analyzer.py", "issues": 1, "worst_severity": "low", "findings": [{"id": "SECRET-HIGH_ENTROPY_STRING", "title": "Secret detected: High Entropy String", "description": "High-entropy string that may be a secret\n\nDetected value: Y3VybCAtcyBodHRwOi8v...", "severity": "low", "line": 122, "remediation": ""}]}], "issues": 1}], "issues": 18}], "issues": 20}], "issues": 20}, {"name": "docs", "type": "directory", "path": "docs", "children": [{"name": "advanced_usage.md", "type": "file", "path": "docs/advanced_usage.md", "issues": 1, "worst_severity": "low", "findings": [{"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.55\nDetected value: $REPORT_DIR/extensio...", "severity": "low", "line": 258, "remediation": ""}]}, {"name": "security_examples.md", "type": "file", "path": "docs/security_examples.md", "issues": 9, "worst_severity": "critical", "findings": [{"id": "SECRET-AWS_ACCESS_KEY_ID", "title": "Secret detected: AWS Access Key ID", "description": "AWS Access Key ID detected\n\nDetected value: AKIAIOSFODNN7EXAMPLE", "severity": "high", "line": 409, "remediation": ""}, {"id": "SECRET-AWS_SECRET_ACCESS_KEY", "title": "Secret detected: AWS Secret Access Key", "description": "Potential AWS Secret Access Key detected\n\nDetected value: wJalrXUtnFEMI/K7MDEN...", "severity": "high", "line": 410, "remediation": ""}, {"id": "SECRET-GITHUB_TOKEN", "title": "Secret detected: GitHub Token", "description": "GitHub Personal Access Token detected\n\nDetected value: ghp_1234567890abcdef...", "severity": "high", "line": 408, "remediation": ""}, {"id": "SECRET-DATABASE_CONNECTION_STRING", "title": "Secret detected: Database Connection String", "description": "Database connection string with embedded credentials detected\n\nDetected value: postgresql://admin:p...", "severity": "high", "line": 351, "remediation": ""}, {"id": "SECRET-BITCOIN_PRIVATE_KEY", "title": "Secret detected: Bitcoin Private Key", "description": "Bitcoin private key detected\n\nDetected value: 5KJvsngHeMpm884wtkJN...", "severity": "critical", "line": 713, "remediation": ""}, {"id": "SECRET-ETHEREUM_PRIVATE_KEY", "title": "Secret detected: Ethereum Private Key", "description": "Ethereum private key detected\n\nDetected value: 0x1234567890abcdef12...", "severity": "critical", "line": 710, "remediation": ""}, {"id": "SECRET-SSH_PRIVATE_KEY", "title": "Secret detected: SSH Private Key", "description": "SSH private key detected\n\nDetected value: -----BEGIN RSA PRIVA...", "severity": "critical", "line": 431, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.57\nDetected value: sk_live_12345abcdef6...", "severity": "low", "line": 352, "remediation": ""}, {"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.79\nDetected value: 1BvBMSEYstWetqTFn5Au...", "severity": "low", "line": 800, "remediation": ""}]}], "issues": 10}, {"name": "src", "type": "directory", "path": "src", "children": [{"name": "insect", "type": "directory", "path": "src/insect", "children": [{"name": "utils", "type": "directory", "path": "src/insect/utils", "children": [{"name": "docker_utils.py", "type": "file", "path": "src/insect/utils/docker_utils.py", "issues": 1, "worst_severity": "low", "findings": [{"id": "SECRET-HIGH_ENTROPY", "title": "High-entropy string detected", "description": "High-entropy string detected that may be a secret.\n\nEntropy: 4.61\nDetected value: DOCKERFILE_TEMPLATE....", "severity": "low", "line": 76, "remediation": ""}]}], "issues": 1}], "issues": 1}], "issues": 1}, {"name": "Dockerfile", "type": "file", "path": "Dockerfile", "issues": 1, "worst_severity": "medium", "findings": [{"id": "DOCKER003-65ffd010", "title": "No USER instruction (running as root)", "description": "No USER instruction found, container will run as root by default.", "severity": "medium", "line": 1, "remediation": "Add a USER instruction to run as a non-privileged user."}]}, {"name": "pyproject.toml", "type": "file", "path": "pyproject.toml", "issues": 1, "worst_severity": "medium", "findings": [{"id": "TOML001-b7c90919", "title": "Insecure dependency version constraints", "description": "Using '*', '>=', or '^' can lead to automatic updates to vulnerable versions.", "severity": "medium", "line": 22, "remediation": "Pin dependencies to specific versions."}]}], "issues": 34};
        const insights = {"alerts": ["\ud83d\udea8 9 CRITICAL", "\u26a0\ufe0f 11 HIGH", "\ud83d\udcca 3 MEDIUM", "\ud83d\udc1b 12 LOW"], "top_types": ["Secret: 32", "Misconfig: 2"], "top_files": ["test_secret_analyzer.py: 10", "security_examples.md: 9"], "recommendations": ["Address critical/high issues first", "Consider automated CI/CD checks"]};
        
        let selectedFile = null;
        let currentIssueIndex = 0;

        // Initialize the dashboard
        function initializeDashboard() {
            renderInsights();
            renderFileTree();
            
            // Add keyboard navigation
            document.addEventListener('keydown', handleKeyPress);
        }

        function renderInsights() {
            const insightsContent = document.getElementById('insights-content');
            let html = '';
            
            if (insights.alerts.length > 0) {
                html += '<div style="margin-bottom: 0.5rem;">' + insights.alerts.join(' | ') + '</div>';
            }
            
            if (insights.top_types.length > 0) {
                html += '<div><strong>üéØ Top Issues:</strong> ' + insights.top_types.join(' | ') + '</div>';
            }
            
            if (insights.top_files.length > 0) {
                html += '<div><strong>üìÅ Top Files:</strong> ' + insights.top_files.join(' | ') + '</div>';
            }
            
            if (insights.recommendations.length > 0) {
                html += '<div><strong>üõ°Ô∏è Actions:</strong> ' + insights.recommendations.join(' | ') + '</div>';
            }
            
            insightsContent.innerHTML = html;
        }

        function renderFileTree() {
            const fileTreeElement = document.getElementById('file-tree');
            fileTreeElement.innerHTML = renderTreeNode(fileTree, 0);
        }

        function renderTreeNode(node, depth) {
            let html = '';
            const indent = '  '.repeat(depth);
            
            if (node.type === 'directory') {
                const hasChildren = node.children && node.children.length > 0;
                const expandIcon = hasChildren ? '<span class="expand-icon">‚ñ∂</span>' : '<span class="expand-icon"> </span>';
                const issueCount = node.issues > 0 ? ` (${node.issues})` : '';
                
                html += `<div class="tree-item directory" data-path="${node.path || ''}" onclick="toggleDirectory('${node.path || ''}')">
                    ${indent}${expandIcon}üìÅ ${node.name}${issueCount}
                </div>`;
                
                if (hasChildren) {
                    html += `<div class="tree-children" id="children-${node.path || 'root'}">`;
                    for (const child of node.children) {
                        html += renderTreeNode(child, depth + 1);
                    }
                    html += '</div>';
                }
            } else if (node.type === 'file' && node.issues > 0) {
                const severityClass = node.worst_severity ? `severity-${node.worst_severity}` : '';
                html += `<div class="tree-item file ${severityClass}" data-path="${node.path}" onclick="selectFile('${node.path}')">
                    ${indent}üìÑ ${node.name} (${node.issues})
                </div>`;
            }
            
            return html;
        }

        function toggleDirectory(path) {
            const childrenElement = document.getElementById(`children-${path || 'root'}`);
            const expandIcon = event.target.querySelector('.expand-icon');
            
            if (childrenElement) {
                childrenElement.classList.toggle('expanded');
                if (expandIcon) {
                    expandIcon.classList.toggle('expanded');
                }
            }
        }

        function selectFile(filePath) {
            // Clear previous selection
            document.querySelectorAll('.tree-item.selected').forEach(el => el.classList.remove('selected'));
            
            // Select new file
            event.target.classList.add('selected');
            selectedFile = filePath;
            currentIssueIndex = 0;
            
            // Find file in tree to get its findings
            const fileNode = findFileInTree(fileTree, filePath);
            if (fileNode && fileNode.findings) {
                renderIssueDetails(fileNode.findings);
            }
        }

        function findFileInTree(node, targetPath) {
            if (node.type === 'file' && node.path === targetPath) {
                return node;
            }
            
            if (node.children) {
                for (const child of node.children) {
                    const result = findFileInTree(child, targetPath);
                    if (result) return result;
                }
            }
            
            return null;
        }

        function renderIssueDetails(issues) {
            const issueContent = document.getElementById('issue-content');
            
            if (!issues || issues.length === 0) {
                issueContent.innerHTML = '<div class="help-text">No issues found in selected file</div>';
                return;
            }
            
            const issue = issues[currentIssueIndex];
            const filename = selectedFile ? selectedFile.split('/').pop() : 'Unknown';
            const navigationInfo = issues.length > 1 ? ` (${currentIssueIndex + 1}/${issues.length})` : '';
            const navHint = issues.length > 1 ? ' | Use navigation buttons below' : '';
            
            let html = `
                <div class="issue-header">
                    <strong>${filename}${navigationInfo}</strong>${navHint}
                </div>
            `;
            
            if (issues.length > 1) {
                html += `
                    <div class="issue-navigation">
                        <div class="nav-buttons">
                            <button class="nav-button" onclick="previousIssue()" ${currentIssueIndex === 0 ? 'disabled' : ''}>
                                ‚Üê Previous
                            </button>
                            <button class="nav-button" onclick="nextIssue()" ${currentIssueIndex === issues.length - 1 ? 'disabled' : ''}>
                                Next ‚Üí
                            </button>
                        </div>
                    </div>
                `;
            }
            
            const severityClass = `severity-${issue.severity}`;
            html += `
                <div class="issue-content">
                    <div style="margin-bottom: 1rem;">
                        <span class="${severityClass}"><strong>${issue.severity.toUpperCase()}</strong></span> - ${issue.title}
                    </div>
            `;
            
            if (issue.line) {
                html += `<div style="margin-bottom: 0.5rem;"><strong>üìç Line ${issue.line}</strong></div>`;
            }
            
            if (issue.description) {
                const desc = issue.description.length > 150 ? issue.description.substring(0, 150) + '...' : issue.description;
                html += `<div style="margin-bottom: 0.5rem;">${desc}</div>`;
            }
            
            if (issue.remediation) {
                const remediation = issue.remediation.length > 150 ? issue.remediation.substring(0, 150) + '...' : issue.remediation;
                html += `<div style="margin-bottom: 0.5rem; color: var(--primary-color);">üí° ${remediation}</div>`;
            }
            
            html += '</div>';
            issueContent.innerHTML = html;
        }

        function nextIssue() {
            const fileNode = findFileInTree(fileTree, selectedFile);
            if (fileNode && fileNode.findings && currentIssueIndex < fileNode.findings.length - 1) {
                currentIssueIndex++;
                renderIssueDetails(fileNode.findings);
            }
        }

        function previousIssue() {
            const fileNode = findFileInTree(fileTree, selectedFile);
            if (fileNode && fileNode.findings && currentIssueIndex > 0) {
                currentIssueIndex--;
                renderIssueDetails(fileNode.findings);
            }
        }

        function handleKeyPress(event) {
            switch(event.key.toLowerCase()) {
                case 'n':
                    nextIssue();
                    break;
                case 'm':
                    previousIssue();
                    break;
                case 'e':
                    exportReport();
                    break;
            }
        }

        function exportReport() {
            // Create a detailed HTML report
            const reportData = {
                metadata: metadata,
                findings: findings,
                timestamp: new Date().toISOString()
            };
            
            // Create and download JSON report
            const dataStr = JSON.stringify(reportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `insect-report-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('Report exported successfully!');
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', initializeDashboard);
    </script>
</body>
</html>
